<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OrderMap</title>
    <link rel="stylesheet" href="/DrumtongCss/default.css">
    <link rel="stylesheet" href="/DrumtongCss/ordermap.css">
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=r6oehvpmcw"></script>
</head>
<body>
    <th:block th:include="/common/header"></th:block>
    <div class="ordermap-mainbox">
        <div class="ordermap-name">주문할 지점을 선택하세요</div>
        <div id="map"></div>
    </div>
    <script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpKeyId=ptbhb8aree&submodules=geocoder"></script>
    
    <script>
    
    const mapDiv = document.getElementById("map");
    
    const map = new naver.maps.Map(mapDiv,{
		center : new naver.maps.LatLng(37.5338151,126.8969784),
		zoom : 17,
		zoomControlOptions:{
			position : naver.maps.Position.TOP_RIGHT,
			style : naver.maps.ZoomControlStyle.SMALL
		}
	});
	
    
	const marker1 = new naver.maps.Marker({
		position : new naver.maps.LatLng(37.5340956,126.8969507),
		map : map
	});
	const marker2 = new naver.maps.Marker({
		position : new naver.maps.LatLng(37.5350961,126.8999555),
		map : map
	});
	const marker3 = new naver.maps.Marker({
		position : new naver.maps.LatLng(37.5338262,126.9009868),
		map : map
	});
	const marker4 = new naver.maps.Marker({
		position : new naver.maps.LatLng(37.5352083,126.8967269),
		map : map
	});
	
	
	let infoWindow = new naver.maps.InfoWindow();
	
	naver.maps.Event.addListener(marker1,"click",function(e){
		infoWindow = new naver.maps.InfoWindow({
			content : contentString
		});
		infoWindow.open(map,marker1);
	});
	naver.maps.Event.addListener(map,"click",function(e){
		console.log(e);
		map.setCenter(e.coord);
		marker.setPosition(e.coord);
		
		naver.maps.Service.reverseGeocode({
			location : e.coord
		},function(status, response){
			console.log(response);
			const address = response.result.items[0].address;
			contentString = [
				"<div class = 'iw-inner'>",
				"<a href=/product/productList>"+address+"</a>",
				"</div>",
				"<div class = 'iw-inner'>",
				"<a href=/product/productList>"+address+"</a>",
				"</div>"
			].join("");
		});
	});
	
	
    </script>
    
</body>
</html>